#!/bin/bash

if [ $# -lt 3 ]; then
  echo "Usage: $0 <INPUT_FILE> <OUTPUT_FILE> <KEY>" 1>&2
  echo "Decipher enciphered database by SQLCipher" 1>&2
  exit 1
fi
 
IFILE=$1
OFILE=$2
KEY="$3"

sqlcipher -line "$IFILE" 'PRAGMA key = "'$KEY'";ATTACH DATABASE "'$OFILE'" AS decrypted_database KEY "";SELECT sqlcipher_export("decrypted_database");DETACH DATABASE decrypted_database;'

# fikr4n 2015
